      # üî∏ Create dummy tokens/secrets for scanner testing (NOT REAL CREDENTIALS)
      - name: Create dummy secrets (for scanning demo only)
        run: |
          mkdir -p output/dummy
          echo "AKIAFAKEACCESSKEY123456" > output/dummy/aws_access_key_id.txt
          echo "wJalrXUtnFEMI/K7MDENG/bPxRfiCYFAKEKEY" > output/dummy/aws_secret_access_key.txt
          echo "ghp_FAKEFAKEFAKEFAKEFAKEFAKEFAKEFAKEFAKE" > output/dummy/github_pat.txt
          echo "-----BEGIN PRIVATE KEY-----" > output/dummy/fake_private_key.pem
          echo "MIIBVgIBADANBgkqhkiG9w0BAQEFAASCAT8wggE7AgEAAkEA..." >> output/dummy/fake_private_key.pem
          echo "-----END PRIVATE KEY-----" >> output/dummy/fake_private_key.pem
          echo "Dummy secrets created for scanner testing (not committed)."

      # üîê Generate REAL cryptographic keys (safe for demo, not cloud credentials)
      - name: Generate real RSA 4096 keypair
        run: |
          mkdir -p output/real
          openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:4096 -out output/real/rsa_4096_private.pem
          openssl rsa -pubout -in output/real/rsa_4096_private.pem -out output/real/rsa_4096_public.pem
          echo "Real RSA 4096 keypair generated."

      - name: Generate real EC keypair (P-384)
        run: |
          openssl ecparam -name secp384r1 -genkey -noout -out output/real/ec_p384_private.pem
          openssl ec -in output/real/ec_p384_private.pem -pubout -out output/real/ec_p384_public.pem
          echo "Real EC P-384 keypair generated."

      - name: Generate real HMAC secret (512-bit)
        run: |
          openssl rand -hex 64 > output/real/hmac_secret_512.hex
          echo "Real HMAC secret generated."

      - name: Generate real JWT signing secret (Base64 512-bit)
        run: |
          openssl rand -base64 64 | tr -d '\n' > output/real/jwt_secret.txt
          echo "Real JWT secret generated."

      - name: Generate real symmetric AES key (256-bit)
        run: |
          openssl rand -hex 32 > output/real/aes_256_key.hex
          echo "Real AES-256 key generated."

      # üîê Generate REAL PEM encoded certificate + private key
      - name: Generate real PEM certificate (self-signed)
        run: |
          mkdir -p output/real/cert

          # Generate private key
          openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -out output/real/cert/demo_cert_key.pem

          # Generate self-signed certificate
          openssl req -new -x509 \
            -key output/real/cert/demo_cert_key.pem \
            -out output/real/cert/demo_cert.pem \
            -days 365 \
            -subj "/C=US/ST=Test/L=Test/O=SolutionEngineering/OU=AgileSecScan/CN=example.local"

          echo "Generated real PEM certificate and private key."

      - name: Mask real secrets in logs
        run: |
          JWT_SECRET=$(cat output/real/jwt_secret.txt)
          echo "::add-mask::$JWT_SECRET"
          echo "Secrets masked in workflow logs."

      - name: Upload generated crypto material
        uses: actions/upload-artifact@v4
        with:
          name: generated-crypto-material
          path: output/
